# TypeScript ì½”ë“œ ê°œì„  ì‚¬í•­

ë¶„ì„ ë‚ ì§œ: 2025-12-21
í”„ë¡œì íŠ¸: shop-nestjs

## ğŸ”´ High Priority - ì¦‰ì‹œ ìˆ˜ì • í•„ìš”

### 1. `any` íƒ€ì… ë‚¨ìš© ì œê±°

#### src/application/common/required_port/http-client.interface.ts:48-49
```typescript
// âŒ í˜„ì¬
params?: Record<string, any>;
data?: any;

// âœ… ê°œì„ ì•ˆ
params?: Record<string, string | number | boolean>;
data?: unknown;  // ë˜ëŠ” ì œë„¤ë¦­ íƒ€ì… ì‚¬ìš©
```

#### src/application/layer-zero/layer-zero.service.ts:35,48
```typescript
// âŒ í˜„ì¬
const response = await this.httpClient.get<Record<string, any>>(url)
const v2Deployment = chainData.deployments?.find((d: any) => d.version === 2)

// âœ… ê°œì„ ì•ˆ
// ì ì ˆí•œ íƒ€ì… ì •ì˜ ì¶”ê°€
type LayerZeroDeployment = {
    version: number;
    eid?: number;
};

type LayerZeroChainDetails = {
    chainType: string;
    nativeChainId?: number;
};

type LayerZeroMetadata = {
    deployments?: LayerZeroDeployment[];
    chainDetails?: LayerZeroChainDetails;
};

const response = await this.httpClient.get<Record<string, LayerZeroMetadata>>(url)
const v2Deployment = chainData.deployments?.find((d) => d.version === 2)
```

#### src/infrastructure/neo4j/neo4j.result.converter.ts:125,135,150
```typescript
// âŒ í˜„ì¬
private validateChainProperties(props: any): asserts props is ChainNodeProperties
private validateTokenProperties(props: any): asserts props is TokenNodeProperties
private validateRelationshipProperties(props: any): asserts props is RelationshipProperties

// âœ… ê°œì„ ì•ˆ
private validateChainProperties(props: unknown): asserts props is ChainNodeProperties
private validateTokenProperties(props: unknown): asserts props is TokenNodeProperties
private validateRelationshipProperties(props: unknown): asserts props is RelationshipProperties
```

#### src/adapter/secondary/http-client/axios-http-client.adapter.ts:74,124,135,148,161,172
```typescript
// âŒ í˜„ì¬
async request<T = any, E = any>(...)
async get<T = any, E = any>(...)
async post<T = any, E = any>(...)
async put<T = any, E = any>(...)
async delete<T = any, E = any>(...)
async patch<T = any, E = any>(...)

// âœ… ê°œì„ ì•ˆ - ê¸°ë³¸ íƒ€ì…ì„ unknownìœ¼ë¡œ
async request<T = unknown, E = unknown>(...)
async get<T = unknown, E = unknown>(...)
async post<T = unknown, E = unknown>(...)
async put<T = unknown, E = unknown>(...)
async delete<T = unknown, E = unknown>(...)
async patch<T = unknown, E = unknown>(...)
```

### 2. íƒ€ì… ì˜¤íƒ€ ìˆ˜ì •

#### src/application/quoter/bridge/stargate/stargate.response.ts:30
```typescript
// âŒ í˜„ì¬
erorr: any,

// âœ… ê°œì„ ì•ˆ
error: string | null,  // ë˜ëŠ” ì ì ˆí•œ ì—ëŸ¬ íƒ€ì… ì •ì˜
```

## ğŸŸ¡ Medium Priority - ì ì§„ì  ê°œì„  ê¶Œì¥

### 3. ê³¼ë„í•œ íƒ€ì… ë‹¨ì–¸ (`as`) ì œê±°

#### src/domain/defi-type.enum.ts:8-14 (getProtocolType)
```typescript
// âŒ í˜„ì¬
export const getProtocolType = (relType: string): ProtocolType => {
    const validValues = Object.values(ProtocolType);
    if (validValues.includes(relType as ProtocolType)) {
        return relType as ProtocolType;
    }
    throw new Error(`Bad ProtocolType string given. given={${relType}}`);
};

// âœ… ê°œì„ ì•ˆ - íƒ€ì… ê°€ë“œ ì‚¬ìš©
function isProtocolType(value: string): value is ProtocolType {
    return Object.values(ProtocolType).includes(value as ProtocolType);
}

export const getProtocolType = (relType: string): ProtocolType => {
    if (isProtocolType(relType)) {
        return relType;  // íƒ€ì… ë‹¨ì–¸ ë¶ˆí•„ìš”
    }
    throw new Error(`Bad ProtocolType string given. given={${relType}}`);
};
```

#### src/domain/defi-type.enum.ts:22-28 (swapProtocolFromString)
```typescript
// âŒ í˜„ì¬
export const swapProtocolFromString = (swapProtocol: string): SwapProtocol => {
    const validValues = Object.values(SwapProtocol);
    if (validValues.includes(swapProtocol as SwapProtocol)) {
        return swapProtocol as SwapProtocol;
    }
    throw new Error(`Bad SwapProtocol string given. given={${swapProtocol}}`);
}

// âœ… ê°œì„ ì•ˆ
function isSwapProtocol(value: string): value is SwapProtocol {
    return Object.values(SwapProtocol).includes(value as SwapProtocol);
}

export const swapProtocolFromString = (swapProtocol: string): SwapProtocol => {
    if (isSwapProtocol(swapProtocol)) {
        return swapProtocol;
    }
    throw new Error(`Bad SwapProtocol string given. given={${swapProtocol}}`);
}
```

#### src/domain/defi-type.enum.ts:35-41 (bridgeProtocolFromString)
```typescript
// âŒ í˜„ì¬
export const bridgeProtocolFromString = (bridgeProtocol: string): BridgeProtocol => {
    const validValues = Object.values(BridgeProtocol);
    if (validValues.includes(bridgeProtocol as BridgeProtocol)) {
        return bridgeProtocol as BridgeProtocol;
    }
    throw new Error(`Bad BridgeProtocol string given. given={${bridgeProtocol}}`);
}

// âœ… ê°œì„ ì•ˆ
function isBridgeProtocol(value: string): value is BridgeProtocol {
    return Object.values(BridgeProtocol).includes(value as BridgeProtocol);
}

export const bridgeProtocolFromString = (bridgeProtocol: string): BridgeProtocol => {
    if (isBridgeProtocol(bridgeProtocol)) {
        return bridgeProtocol;
    }
    throw new Error(`Bad BridgeProtocol string given. given={${bridgeProtocol}}`);
}
```

#### src/domain/defi-type.enum.ts:93-109 (ProtocolInfo ìƒìˆ˜ë“¤)
```typescript
// âŒ í˜„ì¬ - ë¶ˆí•„ìš”í•œ íƒ€ì… ë‹¨ì–¸
const oneInchClassicSwapProtocolInfo = {
    protocolName: SwapProtocol.ONE_INCH,
    protocolType: ProtocolType.SWAP,
    version: "V1",
} as ProtocolInfo

const sushiSwapSimpleProtocolInfo = {
    protocolName: SwapProtocol.SUSHI_SWAP,
    protocolType: ProtocolType.SWAP,
    version: "V1",
} as ProtocolInfo

const stargateBridgeProtocolInfo = {
    protocolName: BridgeProtocol.STARGATE,
    protocolType: ProtocolType.BRIDGE,
    version: "V2",
} as ProtocolInfo

// âœ… ê°œì„ ì•ˆ - íƒ€ì… ë‹¨ì–¸ ì—†ì´ ì •í™•í•œ íƒ€ì… ì‚¬ìš©
const oneInchClassicSwapProtocolInfo: ProtocolInfo = {
    protocolName: SwapProtocol.ONE_INCH,
    protocolType: ProtocolType.SWAP,
    version: "V1",
}

const sushiSwapSimpleProtocolInfo: ProtocolInfo = {
    protocolName: SwapProtocol.SUSHI_SWAP,
    protocolType: ProtocolType.SWAP,
    version: "V1",
}

const stargateBridgeProtocolInfo: ProtocolInfo = {
    protocolName: BridgeProtocol.STARGATE,
    protocolType: ProtocolType.BRIDGE,
    version: "V2",
}
```

#### src/infrastructure/neo4j/neo4j.result.converter.ts:20-21
```typescript
// âŒ í˜„ì¬
const path = record.get(pathVairalbeName) as Path;
const chains = record.get('chains') as Node[];

// âœ… ê°œì„ ì•ˆ - ëŸ°íƒ€ì„ ê²€ì¦ ì¶”ê°€
const pathValue = record.get(pathVairalbeName);
if (!this.isPath(pathValue)) {
    throw new Error('Invalid path structure');
}
const path = pathValue;

const chainsValue = record.get('chains');
if (!Array.isArray(chainsValue) || !chainsValue.every(this.isNode)) {
    throw new Error('Invalid chains structure');
}
const chains = chainsValue;

// í—¬í¼ ë©”ì„œë“œ ì¶”ê°€
private isPath(value: unknown): value is Path {
    return value !== null &&
           typeof value === 'object' &&
           'segments' in value &&
           Array.isArray((value as any).segments);
}

private isNode(value: unknown): value is Node {
    return value !== null &&
           typeof value === 'object' &&
           'properties' in value;
}
```

#### src/infrastructure/neo4j/neo4j.result.converter.ts:70,84,105
```typescript
// âŒ í˜„ì¬
const chainProps = chainNode.properties as ChainNodeProperties;
const tokenProps = tokenNode.properties as TokenNodeProperties;
const relProps = relationship.properties as RelationshipProperties;

// âœ… ê°œì„ ì•ˆ - validate í›„ íƒ€ì… ë‹¨ì–¸ ì œê±°
const chainProps = chainNode.properties;
this.validateChainProperties(chainProps);
// ì´í›„ chainPropsëŠ” ChainNodeProperties íƒ€ì…ìœ¼ë¡œ ì¶”ë¡ ë¨

const tokenProps = tokenNode.properties;
this.validateTokenProperties(tokenProps);

const relProps = relationship.properties;
this.validateRelationshipProperties(relProps);
```

#### src/domain/defi-type.enum.ts:74,83
```typescript
// âŒ í˜„ì¬
if (!validSwapProtocols.includes(info.protocolName as SwapProtocol)) {
if (!validBridgeProtocols.includes(info.protocolName as BridgeProtocol)) {

// âœ… ê°œì„ ì•ˆ - discriminated union í™œìš©
export const validateProtocolInfo = (info: ProtocolInfo): void => {
    if (info.protocolType === ProtocolType.SWAP) {
        const validSwapProtocols = Object.values(SwapProtocol);
        // info.protocolNameì€ ì´ë¯¸ SwapProtocol íƒ€ì…ìœ¼ë¡œ ì¢í˜€ì§
        if (!validSwapProtocols.includes(info.protocolName)) {
            throw new Error(
                `ProtocolInfo validation failed: protocolType is SWAP but protocolName "${info.protocolName}" is not a valid SwapProtocol. ` +
                `Valid values: ${validSwapProtocols.join(', ')}`
            );
        }
    } else if (info.protocolType === ProtocolType.BRIDGE) {
        const validBridgeProtocols = Object.values(BridgeProtocol);
        // info.protocolNameì€ ì´ë¯¸ BridgeProtocol íƒ€ì…ìœ¼ë¡œ ì¢í˜€ì§
        if (!validBridgeProtocols.includes(info.protocolName)) {
            throw new Error(
                `ProtocolInfo validation failed: protocolType is BRIDGE but protocolName "${info.protocolName}" is not a valid BridgeProtocol. ` +
                `Valid values: ${validBridgeProtocols.join(', ')}`
            );
        }
    }
};
```

### 4. íƒ€ì… ê°€ë“œ ê°œì„ 

#### src/domain/defi-type.enum.ts:56-62
```typescript
// âš ï¸ í˜„ì¬ - ë°˜í™˜ íƒ€ì…ì´ ì •í™•í•˜ì§€ ì•ŠìŒ
export const isSwapProtocol = (info: ProtocolInfo): info is ProtocolInfo & { type: ProtocolType.SWAP } => {
    return info.protocolType === ProtocolType.SWAP;
};

export const isBridgeProtocol = (info: ProtocolInfo): info is ProtocolInfo & { type: ProtocolType.BRIDGE } => {
    return info.protocolType === ProtocolType.BRIDGE;
};

// âœ… ê°œì„ ì•ˆ - Extract ìœ í‹¸ë¦¬í‹° íƒ€ì… ì‚¬ìš©
export const isSwapProtocol = (
    info: ProtocolInfo
): info is Extract<ProtocolInfo, { protocolType: ProtocolType.SWAP }> => {
    return info.protocolType === ProtocolType.SWAP;
};

export const isBridgeProtocol = (
    info: ProtocolInfo
): info is Extract<ProtocolInfo, { protocolType: ProtocolType.BRIDGE }> => {
    return info.protocolType === ProtocolType.BRIDGE;
};
```

## ğŸŸ¢ Low Priority - ì„ íƒì  ê°œì„ 

### 5. íƒ€ì… ë‹¨ì–¸ ëŒ€ì‹  íƒ€ì… í—¬í¼ í™œìš©

#### src/utils/time/duration.ms.ts:4-13
```typescript
// âŒ í˜„ì¬
export const DurationMs = {
  seconds: (n: number) => n * 1000 as DurationMs,
  minutes: (n: number) => n * 60 * 1000 as DurationMs,
  // ...
  ONE_MINUTE: 60 * 1000 as DurationMs,
  ONE_HOUR: 60 * 60 * 1000 as DurationMs,
} as const;

// âœ… ê°œì„ ì•ˆ - íƒ€ì… í—¬í¼ í•¨ìˆ˜
const createDurationMs = (ms: number): DurationMs => ms as DurationMs;

export const DurationMs = {
  seconds: (n: number) => createDurationMs(n * 1000),
  minutes: (n: number) => createDurationMs(n * 60 * 1000),
  hours: (n: number) => createDurationMs(n * 60 * 60 * 1000),
  days: (n: number) => createDurationMs(n * 24 * 60 * 60 * 1000),

  ONE_MINUTE: createDurationMs(60 * 1000),
  FIVE_MINUTES: createDurationMs(5 * 60 * 1000),
  ONE_HOUR: createDurationMs(60 * 60 * 1000),
  ONE_DAY: createDurationMs(24 * 60 * 60 * 1000),
} as const;
```

#### src/domain/evm-address.class.ts:17
```typescript
// âŒ í˜„ì¬
return this.hash as Hash

// âœ… ê°œì„ ì•ˆ - íƒ€ì… ì •ì˜ë¥¼ ëª…í™•íˆ
// Hash íƒ€ì…ê³¼ ë‚´ë¶€ hash í•„ë“œì˜ íƒ€ì…ì´ ë™ì¼í•˜ë‹¤ë©´ ë‹¨ì–¸ ë¶ˆí•„ìš”
// ì•„ë‹ˆë©´ ìƒì„±ìì—ì„œ íƒ€ì… ê²€ì¦ ì¶”ê°€
```

## ğŸ“Š ê°œì„  ìš°ì„ ìˆœìœ„ ìš”ì•½

### 1ë‹¨ê³„ (ì¦‰ì‹œ): High Priority í•­ëª©
- HTTP í´ë¼ì´ì–¸íŠ¸ ì¸í„°í˜ì´ìŠ¤ `any` â†’ `unknown` ë³€ê²½
- `stargate.response.ts`ì˜ `erorr` ì˜¤íƒ€ ìˆ˜ì •
- Validation í•¨ìˆ˜ë“¤ `any` â†’ `unknown` ë³€ê²½
- LayerZero ì„œë¹„ìŠ¤ íƒ€ì… ì •ì˜ ì¶”ê°€

### 2ë‹¨ê³„ (1-2ì£¼ ë‚´): Medium Priority í•­ëª©
- Enum ë³€í™˜ í•¨ìˆ˜ë“¤ì— íƒ€ì… ê°€ë“œ ì ìš©
- ProtocolInfo ìƒìˆ˜ íƒ€ì… ë‹¨ì–¸ ì œê±°
- Neo4j ê²°ê³¼ ë³€í™˜ê¸° íƒ€ì… ë‹¨ì–¸ ìµœì†Œí™”
- validateProtocolInfo discriminated union í™œìš©

### 3ë‹¨ê³„ (ì ì§„ì ): Low Priority í•­ëª©
- DurationMs í—¬í¼ í•¨ìˆ˜í™”
- ê¸°íƒ€ íƒ€ì… ë‹¨ì–¸ ì •ë¦¬

## ğŸ“ˆ ì˜ˆìƒ íš¨ê³¼

1. **íƒ€ì… ì•ˆì „ì„± í–¥ìƒ**: `any` ì œê±°ë¡œ ì»´íŒŒì¼ íƒ€ì„ ì—ëŸ¬ ê°ì§€ ì¦ê°€
2. **ì½”ë“œ ê°€ë…ì„± ê°œì„ **: íƒ€ì… ë‹¨ì–¸ ê°ì†Œë¡œ ì˜ë„ê°€ ëª…í™•í•´ì§
3. **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**: íƒ€ì… ê°€ë“œë¡œ ëŸ°íƒ€ì„ ê²€ì¦ ê°•í™”
4. **ë¦¬íŒ©í† ë§ ì•ˆì „ì„±**: íƒ€ì… ì‹œìŠ¤í…œì´ ë³€ê²½ì‚¬í•­ ì¶”ì 

## ğŸ”§ ì ìš© ë°©ë²•

ê° íŒŒì¼ë³„ë¡œ ì ì§„ì ìœ¼ë¡œ ì ìš©í•˜ë˜, ë³€ê²½ í›„ ë°˜ë“œì‹œ:
1. íƒ€ì… ì²´í¬: `npm run build` ë˜ëŠ” `tsc --noEmit`
2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰: `npm test`
3. ë¦°íŠ¸ ì²´í¬: `npm run lint`

## ì°¸ê³  ì‚¬í•­

- tsconfig.jsonì˜ strict ì„¤ì •ì€ ì˜ ë˜ì–´ ìˆìŒ (noImplicitAny, strictNullChecks ë“±)
- `@ts-ignore`, `@ts-nocheck` ì‚¬ìš© ì—†ìŒ (ì¢‹ìŒ)
- ì „ë°˜ì ìœ¼ë¡œ íƒ€ì… ì‹œìŠ¤í…œì„ í™œìš©í•˜ë ¤ëŠ” ì˜ì§€ê°€ ë³´ì„
- ì£¼ë¡œ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ íƒ€ì…ê³¼ì˜ ìƒí˜¸ì‘ìš©ì—ì„œ íƒ€ì… ë‹¨ì–¸ì´ ë§ì´ ì‚¬ìš©ë¨
